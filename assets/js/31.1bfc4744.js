(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{368:function(t,a,s){"use strict";s.r(a);var e=s(34),n=Object(e.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"other-integrations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#other-integrations","aria-hidden":"true"}},[t._v("#")]),t._v(" Other Integrations")]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#ids-integration"}},[t._v("IDS Integration")]),s("ul",[s("li",[s("a",{attrs:{href:"#csf-integration"}},[t._v("CSF Integration")])]),s("li",[s("a",{attrs:{href:"#cxs-integration"}},[t._v("CXS Integration")])])])]),s("li",[s("a",{attrs:{href:"#backup-providers-integration"}},[t._v("Backup Providers Integration")]),s("ul",[s("li",[s("a",{attrs:{href:"#overview"}},[t._v("Overview")])]),s("li",[s("a",{attrs:{href:"#command-line-usage"}},[t._v("Command Line Usage")])]),s("li",[s("a",{attrs:{href:"#using-as-library"}},[t._v("Using as Library")])]),s("li",[s("a",{attrs:{href:"#creating-custom-backup-backend-plugin"}},[t._v("Creating Custom Backup Backend Plugin")])])])]),s("li",[s("a",{attrs:{href:"#hosting-panels-firewall-rulesets-specific-settings-modsecurity"}},[t._v("Hosting Panels Firewall Rulesets Specific Settings & ModSecurity")]),s("ul",[s("li",[s("a",{attrs:{href:"#cpanel"}},[t._v("cPanel")])]),s("li",[s("a",{attrs:{href:"#plesk"}},[t._v("Plesk")])]),s("li",[s("a",{attrs:{href:"#directadmin"}},[t._v("DirectAdmin")])])])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"ids-integration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ids-integration","aria-hidden":"true"}},[t._v("#")]),t._v(" IDS Integration")]),t._v(" "),s("h3",{attrs:{id:"csf-integration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#csf-integration","aria-hidden":"true"}},[t._v("#")]),t._v(" CSF Integration")]),t._v(" "),s("p",[t._v("It is possible to use "),s("span",{staticClass:"notranslate"},[s("a",{attrs:{href:"https://www.configserver.com/cp/csf.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ConfigServer Security & Firewall (CSF)"),s("OutboundLink")],1)]),t._v("  along with Imunify360.")]),t._v(" "),s("p",[t._v("Imunify360 automatically detects that CSF is running (you can enable it anytime). Imunify360 "),s("RouterLink",{attrs:{to:"/dashboard/#blocked-ports"}},[t._v("Blocked Ports")]),t._v(", "),s("RouterLink",{attrs:{to:"/dashboard/#dos-protection"}},[t._v("DoS Protection")]),t._v(" and "),s("RouterLink",{attrs:{to:"/dashboard/#smtp-traffic-manager"}},[t._v("SMTP Traffic Manager")]),t._v(" features are automatically disabled in this case. In general:")],1),t._v(" "),s("ul",[s("li",[s("span",{staticClass:"notranslate"},[t._v("Black List, Gray List")]),t._v(", and "),s("span",{staticClass:"notranslate"},[t._v("White List")]),t._v(" can be managed in Imunify360 regardless of "),s("span",{staticClass:"notranslate"},[t._v("CSF")]),t._v(".")]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[t._v("CSF Allow, Deny")]),t._v(" and "),s("span",{staticClass:"notranslate"},[t._v("Ignore Lists")]),t._v(" are not automatically imported from "),s("span",{staticClass:"notranslate"},[t._v("CSF")]),t._v(". They can still be managed using "),s("span",{staticClass:"notranslate"},[t._v("CSF")]),t._v(" interface.")]),t._v(" "),s("li",[t._v("Imunify360 will not block addresses from "),s("span",{staticClass:"notranslate"},[t._v("CSF Allow")]),t._v(" and "),s("span",{staticClass:"notranslate"},[t._v("Ignore Lists")]),t._v(".")])]),t._v(" "),s("p",[t._v("To check that running "),s("span",{staticClass:"notranslate"},[t._v("CSF")]),t._v(" is detected, go to "),s("span",{staticClass:"notranslate"},[t._v("Imunify360 → Firewall tab → White List")]),t._v(" section and check if there is a warning message "),s("span",{staticClass:"notranslate"},[t._v('"'),s("em",[t._v("CSF is enabled. Please manage IPs whitelisted in CSF using CSF user interface or config file")]),t._v('"')]),t._v(".")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/firewallblacklistwarning_zoom70.png",alt:""}})]),t._v(" "),s("p",[s("strong",[s("span",{staticClass:"notranslate"},[t._v("Mod_security")]),t._v(" recommendations")])]),t._v(" "),s("p",[t._v("When "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" is configured with "),s("span",{staticClass:"notranslate"},[t._v("SecRuleEngine On")]),t._v(" (blocking mode), "),s("span",{staticClass:"notranslate"},[t._v("CSF")]),t._v(" blocks IP addresses by "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" events. The number of events to block IP address is defined by "),s("span",{staticClass:"notranslate"},[s("code",[t._v("LF_MODSEC")])]),t._v(" variable in "),s("span",{staticClass:"notranslate"},[s("code",[t._v("csf.conf")])]),t._v(". This can lead to a large number of false positives.")]),t._v(" "),s("p",[t._v("We recommend to set "),s("span",{staticClass:"notranslate"},[s("code",[t._v("LF_MODSEC")])]),t._v(" variable to 0.")]),t._v(" "),s("p",[t._v("In this case, Imunify360 will block IPs only by "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" events with high severity.")]),t._v(" "),s("h4",{attrs:{id:"_3-rd-party-integration-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-rd-party-integration-mode","aria-hidden":"true"}},[t._v("#")]),t._v(" 3-rd Party Integration mode")]),t._v(" "),s("p",[t._v("The main setting that defines how Imunify360 works along with CSF is "),s("a",{attrs:{href:"https://docs.imunify360.com/dashboard/#_3-rd-party-integration",target:"_blank",rel:"noopener noreferrer"}},[t._v("3-rd Party Integration"),s("OutboundLink")],1),t._v(" switch. (The "),s("RouterLink",{attrs:{to:"/config_file_description/"}},[t._v("config file")]),t._v(" equivalent is "),s("code",[t._v("CSF_INTEGRATION.catch_lfd_events")]),t._v("). When this mode is "),s("strong",[t._v("disabled")]),t._v(" (default), CSF and Imunify360 work as two independent solutions (with redundant modules disabled on the Imunify360 side - see above).")],1),t._v(" "),s("p",[t._v("When 3-rd Party Integration mode is "),s("strong",[t._v("enabled")]),t._v(" Imunify360 uses "),s("span",{staticClass:"notranslate"},[t._v("Login Failure Daemon (LFD)")]),t._v(" as source for security events instead of "),s("span",{staticClass:"notranslate"},[s("a",{attrs:{href:"https://www.ossec.net",target:"_blank",rel:"noopener noreferrer"}},[t._v("OSSEC"),s("OutboundLink")],1)]),t._v(". To get events from "),s("span",{staticClass:"notranslate"},[t._v("Login Failure Daemon (LFD)")]),t._v(", Imunify360 automatically replaces "),s("span",{staticClass:"notranslate"},[s("code",[t._v("BLOCK_REPORT")])]),t._v(" variable to the file path of Imunify360 script.\nWhen some IP address is blocked by "),s("span",{staticClass:"notranslate"},[t._v("LFD, Imunify360")]),t._v(" adds this IP address to its "),s("span",{staticClass:"notranslate"},[t._v("Graylist")]),t._v(" and then "),s("strong",[t._v("removes it from "),s("span",{staticClass:"notranslate"},[t._v("CSF deny/tempdeny lists")])]),t._v(". The latter is done to allow the IP to have access to the Captcha and to store all automatically blocked IP addresses in a single place. Thus, no IP is automatically added to "),s("span",{staticClass:"notranslate"},[t._v("CSF deny/tempdeny lists")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"cxs-integration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cxs-integration","aria-hidden":"true"}},[t._v("#")]),t._v(" CXS Integration")]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("a",{attrs:{href:"https://configserver.com/cp/cxs.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ConfigServer eXploit Scanner"),s("OutboundLink")],1),t._v(" (CXS)")]),t._v(" has different types of malware scanning, which affects "),s("span",{staticClass:"notranslate"},[t._v("Imunify360 Malware Scanner")]),t._v(" functionality. Below we describe how to make "),s("span",{staticClass:"notranslate"},[t._v("Imunify360 Malware Scanner")]),t._v(" work properly. These functionalities can be configured at "),s("span",{staticClass:"notranslate"},[s("RouterLink",{attrs:{to:"/dashboard/#settings"}},[t._v("Malware Scanner settings")])],1),t._v(" page, but "),s("span",{staticClass:"notranslate"},[t._v("CXS")]),t._v(" itself must be configured  as follows:")]),t._v(" "),s("ol",[s("li",[s("p",[s("span",{staticClass:"notranslate"},[s("em",[t._v("Automatically scan all modified files")])])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[t._v("CXS Watch")]),t._v(" daemon must be disabled.")])]),t._v(" "),s("li",[s("p",[s("span",{staticClass:"notranslate"},[s("em",[t._v("Automatically scan any files uploaded using web")])])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[t._v("CXS ModSecurity")]),t._v(" vendor should be disabled.")])]),t._v(" "),s("li",[s("p",[s("span",{staticClass:"notranslate"},[s("em",[t._v("Automatically scan any file uploaded using ftp")])])]),t._v(" "),s("p",[t._v("Imunify360 supports only "),s("span",{staticClass:"notranslate"},[s("a",{attrs:{href:"https://www.pureftpd.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("Pure-FTPd"),s("OutboundLink")],1)]),t._v(". For "),s("span",{staticClass:"notranslate"},[t._v("Pure-FTPd CXS")]),t._v(" launches pure-uploadscript for the scan. Any pure-uploadscript used by "),s("span",{staticClass:"notranslate"},[t._v("CXS")]),t._v(" must be disabled. You can use the following commands to do that:")])])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("systemctl stop pure-uploadscript.service\n")])])])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("systemctl disable pure-uploadscript.service\n")])])])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("systemctl restart imunify360\n")])])])]),t._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[s("p",[s("span",{staticClass:"notranslate"},[s("em",[t._v("On-Demand scanning")])])]),t._v(" "),s("p",[t._v("This type of scanning can be always run by Imunify360 and "),s("span",{staticClass:"notranslate"},[t._v("CXS")]),t._v(" separately. No special actions required.")])])]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("Imunify360 doesn’t make any imports from "),s("span",{staticClass:"notranslate"},[t._v("CXS")]),t._v(".")])]),s("h2",{attrs:{id:"backup-providers-integration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#backup-providers-integration","aria-hidden":"true"}},[t._v("#")]),t._v(" Backup Providers Integration")]),t._v(" "),s("h3",{attrs:{id:"overview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#overview","aria-hidden":"true"}},[t._v("#")]),t._v(" Overview")]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("strong",[t._v("Restore_infected")])]),t._v(" is a library written in "),s("span",{staticClass:"notranslate"},[t._v("Python 3")]),t._v(". It allows to restore files from backups. It supports several backup backends. Each backend is represented as a plugin which uses a particular API to the backup server and provides a user with a common interface to restore individual files regardless of backup backend selected. In addition to the existing backends custom ones can be added.")]),t._v(" "),s("p",[t._v("If one of the files is infected with malware the library can also search for the last uninfected revision of this file in available backups and restore it. By default it uses "),s("span",{staticClass:"notranslate"},[s("em",[t._v("imunify360-agent")])]),t._v(" to detect infected files but a custom algorithm can be used instead.")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/restoreinfectedscheme_zoom70.png",alt:""}})]),t._v(" "),s("p",[t._v("From the figure above can see that the user of the library is supposed to reference it either using command line interface or calling library functions directly. The CLI supports interaction with the "),s("span",{staticClass:"notranslate"},[s("em",[t._v("restore algorithm")])]),t._v(" but not with the backend API. "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Restore algorithm")])]),t._v(" doesn’t have a functionality to restore a file from any backup but is capable of restoring files infected with malware instead. It treats absent files as infected ones therefore restores the last revision of those.")]),t._v(" "),s("h3",{attrs:{id:"command-line-usage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#command-line-usage","aria-hidden":"true"}},[t._v("#")]),t._v(" Command Line Usage")]),t._v(" "),s("p",[t._v("A command line interface to "),s("span",{staticClass:"notranslate"},[s("strong",[t._v("restore_infected")])]),t._v(" library is present in the file "),s("span",{staticClass:"notranslate"},[s("strong",[t._v("restore_infected_cli.py")])]),t._v(". If installed from the RPM, the binary is located in "),s("span",{staticClass:"notranslate"},[s("em",[t._v("/usr/bin/restore_infected")])]),t._v(" and can be used as "),s("span",{staticClass:"notranslate"},[s("em",[t._v("“restore_infected”")])]),t._v(" . To use the CLI a backend and an action should be specified.")]),t._v(" "),s("p",[t._v("The library includes the following backup backend plugins:")]),t._v(" "),s("ul",[s("li",[t._v("Acronis")]),t._v(" "),s("li",[t._v("cPanel")]),t._v(" "),s("li",[t._v("Plesk")])]),t._v(" "),s("h4",{attrs:{id:"synopsis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#synopsis","aria-hidden":"true"}},[t._v("#")]),t._v(" Synopsis")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("restore_infected BACKEND ACTION\n")])])])]),t._v(" "),s("p",[t._v("Where "),s("span",{staticClass:"notranslate"},[s("code",[t._v("BACKEND")])]),t._v(" is one of the backends - predefined or custom and "),s("span",{staticClass:"notranslate"},[s("code",[t._v("ACTION")])]),t._v(" is one of the actions described below.")]),t._v(" "),s("h4",{attrs:{id:"actions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#actions","aria-hidden":"true"}},[t._v("#")]),t._v(" Actions")]),t._v(" "),s("h4",{attrs:{id:"init"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#init","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("span",{staticClass:"notranslate"},[t._v("init")])]),t._v(" "),s("p",[t._v("The first step most of the plugins will need is initialization. The most common use of it is to save credentials for the backup server.")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("init arg0 arg1 ...\n")])])])]),t._v(" "),s("p",[t._v("The arguments may vary depending on the backend used. To see which arguments are needed for the particular plugin you can call "),s("span",{staticClass:"notranslate"},[s("code",[t._v("init")])]),t._v(" with no arguments:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("restore_infected acronis init\nusage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" restore_infected "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("h"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" BACKEND "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("restore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cleanup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nrestore_infected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" init arguments required"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" username password\n")])])])]),t._v(" "),s("p",[t._v("To install Acronis backup agent, pass "),s("span",{staticClass:"notranslate"},[s("code",[t._v("--provision")])]),t._v(" option to "),s("span",{staticClass:"notranslate"},[s("code",[t._v("init")])]),t._v(" command. To force installation when agent is present use "),s("span",{staticClass:"notranslate"},[s("code",[t._v("--force")])]),t._v(" option.")]),t._v(" "),s("h4",{attrs:{id:"list"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#list","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("span",{staticClass:"notranslate"},[t._v("list")])]),t._v(" "),s("p",[t._v("list shows available backups sorted by date starting with the newest.")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("list [--until]\n")])])])]),t._v(" "),s("p",[t._v("If a date string is passed as "),s("span",{staticClass:"notranslate"},[s("code",[t._v("--until")])]),t._v(", list all backups from now up to that date or all backups otherwise. The date for "),s("span",{staticClass:"notranslate"},[s("code",[t._v("--until")])]),t._v(" parameter can be in any format that python-dateutil can parse, e.g. "),s("em",[t._v("2017-08-01")]),t._v(", "),s("em",[t._v("01 Aug 2017")]),t._v(", etc.")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("restore_infected acronis "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("until "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"01 Aug 2017"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("06T10"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("05T06"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("03T12"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),t._v("\n")])])])]),t._v(" "),s("h4",{attrs:{id:"restore"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#restore","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("span",{staticClass:"notranslate"},[t._v("restore")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("restore files [--until]\n")])])])]),t._v(" "),s("p",[t._v("Restore files from backup. "),s("span",{staticClass:"notranslate"},[s("code",[t._v("restore")])]),t._v(" takes a list of files (paths to them) which are considered infected, searches for the first uninfected entry of each file in backups and restores it. Backups older than the date set in "),s("span",{staticClass:"notranslate"},[s("code",[t._v("--until")])]),t._v(" are not considered.")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('restore_infected acronis restore "/root/file1" "/root/file2" --until "01 Aug 2017"\n')])])])]),t._v(" "),s("h4",{attrs:{id:"cleanup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cleanup","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("span",{staticClass:"notranslate"},[t._v("cleanup")])]),t._v(" "),s("p",[t._v("The most common use is to delete any temporary files created by the plugin. Depending on the backend the functionality may vary or such function might not be present at all.")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("restore_infected plesk cleanup\n")])])])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("strong",[t._v("extra")])])]),t._v(" "),s("p",[t._v("This is for acrivity not connected to restoring from backups.")]),t._v(" "),s("p",[t._v("Currently supported options are")]),t._v(" "),s("ul",[s("li",[s("span",{staticClass:"notranslate"},[s("code",[t._v("login_url")])]),t._v(" (for Acronis backend). This option returns url to log in to Acronis cloud web interface.")]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[s("code",[t._v("refresh_token")])]),t._v(" (for Acronis backend). This option refreshes authentication token to keep it valid.")])]),t._v(" "),s("h3",{attrs:{id:"using-as-library"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-as-library","aria-hidden":"true"}},[t._v("#")]),t._v(" Using as Library")]),t._v(" "),s("h4",{attrs:{id:"restoring-infected-files"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#restoring-infected-files","aria-hidden":"true"}},[t._v("#")]),t._v(" Restoring Infected Files")]),t._v(" "),s("p",[t._v("The main purpose of the library is to search for uninfected files and to restore them as a replacement for infected ones. The function responsible for that is located in a module "),s("span",{staticClass:"notranslate"},[s("code",[t._v("restore_infected.restore")])]),t._v(":")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("restore_infected(backend, files, until=None, scan_func=scan)\n")])])])]),t._v(" "),s("p",[t._v("Where:")]),t._v(" "),s("ul",[s("li",[s("span",{staticClass:"notranslate"},[s("code",[t._v("backend")])]),t._v(" is a backend plugin module;")]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[s("code",[t._v("files")])]),t._v(" is a list of files to scan and restore;")]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[s("code",[t._v("until")])]),t._v(" filters the backups before specified date;")]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[s("code",[t._v("scan_func")])]),t._v(" is a function that scans files for malware. It takes a list of files and returns the list of infected ones, by default it uses the function "),s("span",{staticClass:"notranslate"},[s("code",[t._v("scan")])]),t._v(" from the same module.")])]),t._v(" "),s("p",[t._v("For example "),s("span",{staticClass:"notranslate"},[s("code",[t._v("restore_infected")])]),t._v(" can be called like this:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" backup_backends\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("restore "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" restore_infected\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("helpers "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" DateTime\n \nplesk "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" backup_backends"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'plesk'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("my_scan")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("files"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  infected "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# scan files here")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" infected\n \nrestore_infected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nplesk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/var/www/vhosts/u1.pl7.cloudlinux.com/httpdocs/index.php"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nuntil"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("DateTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9 Aug 2017"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nscan_func"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("my_scan"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("h4",{attrs:{id:"operating-with-backend"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#operating-with-backend","aria-hidden":"true"}},[t._v("#")]),t._v(" Operating With Backend")]),t._v(" "),s("p",[t._v("A backend plugin can be imported directly from "),s("span",{staticClass:"notranslate"},[s("code",[t._v("restore_infected.backup_backends")])]),t._v(". Every plugin has a function called "),s("span",{staticClass:"notranslate"},[s("code",[t._v("backups")])]),t._v(" which returns the list of objects each of which is representing a backup, and might have optional functions "),s("span",{staticClass:"notranslate"},[s("code",[t._v("init")])]),t._v(" and/or "),s("span",{staticClass:"notranslate"},[s("code",[t._v("cleanup")])]),t._v(" which initialize and cleanup the plugin respectively.")]),t._v(" "),s("p",[t._v("In the following example let’s print out all backups. For "),s("span",{staticClass:"notranslate"},[s("code",[t._v("plesk")])]),t._v(" in the following example the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("init")])]),t._v(" function is not needed so we can call backups right away:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" backup_backends\nplesk "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" backup_backends"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'plesk'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" backup "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" plesk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backups"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("backup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("p",[t._v("This will give us the following list of backups:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("/var/lib/psa/dumps/clients/u3/domains/u3.pl7.cloudlinux.com/backup_info_1708080701_1708090501.xml\n/var/lib/psa/dumps/clients/u1/domains/u1.pl7.cloudlinux.com/backup_info_1708090500.xml\n<...>\n/var/lib/psa/dumps/clients/u1/domains/u1.pl7.cloudlinux.com/backup_info_1707070347_1707070353.xml\n/var/lib/psa/dumps/clients/u1/domains/u1.pl7.cloudlinux.com/backup_info_1707070347.xml\n")])])])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("backups")])]),t._v(" has an optional parameter "),s("span",{staticClass:"notranslate"},[s("code",[t._v("until")])]),t._v(" of "),s("span",{staticClass:"notranslate"},[s("code",[t._v("restore_infected.helpers.DateTime")])]),t._v(". To filter out backups from 9 Aug 2017 till now the code can be changed like this:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" backup_backends\nplesk "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" backup_backends"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'plesk'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("helpers "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" DateTime\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" backup "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" plesk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backups"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DateTime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9 Aug 2017"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("backup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("h4",{attrs:{id:"operating-with-backup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#operating-with-backup","aria-hidden":"true"}},[t._v("#")]),t._v(" Operating With Backup")]),t._v(" "),s("p",[t._v("In the previous step we printed out some backups. Every backup entry regardless of the plugin also has a field "),s("span",{staticClass:"notranslate"},[s("code",[t._v("created")])]),t._v(" which tells when the actual backup was created. It makes backups comparable.")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("backups "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" plesk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backups"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("backups"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("created"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("backups"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("created"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("backups"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" backups"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nWhich gives us"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("07")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("01")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("08")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("07")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n")])])])]),t._v(" "),s("h4",{attrs:{id:"operating-with-file-in-backup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#operating-with-file-in-backup","aria-hidden":"true"}},[t._v("#")]),t._v(" Operating With File in Backup")]),t._v(" "),s("p",[t._v("A method "),s("span",{staticClass:"notranslate"},[s("code",[t._v("file_data")])]),t._v(" returns a representation of a file in this backup as an instance of a class (hereafter, this class is referenced to "),s("span",{staticClass:"notranslate"},[s("code",[t._v("FileData")])]),t._v("):")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("print(backup.file_data('/var/www/vhosts/u1.pl7.cloudlinux.com/httpdocs/index.php'))\n")])])])]),t._v(" "),s("p",[t._v("Output:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("FileData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\nfileobj"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ExFileObject name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/var/lib/psa/dumps/clients/u1/domains/u1.pl7.cloudlinux.com/backup_user-data_1708080700.tgz'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nfilename"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/var/www/vhosts/u1.pl7.cloudlinux.com/httpdocs/index.php'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nsize"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("418")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\nmtime"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("datetime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("datetime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2013")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" \n")])])])]),t._v(" "),s("p",[t._v("where "),s("span",{staticClass:"notranslate"},[s("code",[t._v("mtime")])]),t._v(" is the time of the last modification of a file.")]),t._v(" "),s("p",[t._v("Besides these fields, FileData also has a method "),s("span",{staticClass:"notranslate"},[s("code",[t._v("restore")])]),t._v(". If "),s("span",{staticClass:"notranslate"},[s("code",[t._v("destination")])]),t._v(" is passed as a parameter then the file is restored and saved in specified folder saving the directory hierarchy. The default "),s("span",{staticClass:"notranslate"},[s("code",[t._v("destination")])]),t._v(" is "),s("code",[t._v("/")]),t._v(" which means that the file is restored to the place of its origin.")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" backup_backends\nplesk "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" backup_backends"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'plesk'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nbackups "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" plesk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backups"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nfiledata "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" \\\nbackups"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("file_data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/var/www/vhosts/u1.pl7.cloudlinux.com/httpdocs/index.php'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nfiledata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("restore"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/home/user/restored_files'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("p",[t._v("It gives no output if zero errors occurred and creates "),s("span",{staticClass:"notranslate"},[s("code",[t._v("'var/...'")])]),t._v(" directories in "),s("span",{staticClass:"notranslate"},[s("code",[t._v("'/home/user/restored_files'")])]),t._v(" with a restored file.")]),t._v(" "),s("p",[t._v("From now on Acronis backend supports "),s("span",{staticClass:"notranslate"},[s("code",[t._v("provision=True/False")])]),t._v(" (by default "),s("span",{staticClass:"notranslate"},[s("code",[t._v("False")])]),t._v(") and "),s("span",{staticClass:"notranslate"},[s("code",[t._v("force=True/False")])]),t._v(" (by default "),s("span",{staticClass:"notranslate"},[s("code",[t._v("False")])]),t._v(") options for "),s("span",{staticClass:"notranslate"},[s("code",[t._v("init")])]),t._v(" action, to install Acronis backend agent. Use "),s("span",{staticClass:"notranslate"},[s("code",[t._v("force")])]),t._v(" to reinstall agent if it is already present.")]),t._v(" "),s("p",[t._v("As of version 1.2-1, Acronis "),s("span",{staticClass:"notranslate"},[s("code",[t._v("init")])]),t._v(" takes optional argument "),s("span",{staticClass:"notranslate"},[s("code",[t._v("tmp_dir")])]),t._v(" to specify temporal directory for installing Acronis backup client.")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" backup_backends\nacronis "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" backup_backends"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'acronis'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nacronis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" password"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" provision"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" force"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tmp_dir"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("ul",[s("li",[s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("login_url")])]),t._v(" action for return URL to log in to Acronis web interface.")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" backup_backends\n acronis "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" backup_backends"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'acronis'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n token "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" acronis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("login_url"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),s("li",[s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("login_url")])]),t._v(" action for refreshing authentication token.")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" backup_backends\n  acronis "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" backup_backends"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'acronis'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n acronis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("refresh_token"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])]),t._v(" "),s("li",[s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("info")])]),t._v(" action to return region, schedule and used storage space in JSON format.")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" backup_backends\n acronis "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" backup_backends"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'acronis'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n info "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" acronis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'schedule'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'usage'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("17890969600")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'region'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'eu2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])]),t._v(" "),s("li",[s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("make_initial_backup")])]),t._v(" makes initial backup after Acronis backup client is installed. By default it does not wait for the backup completion. To wait for the backup to be completed use option "),s("span",{staticClass:"notranslate"},[s("code",[t._v("trace=True")])]),t._v(" . When such an option is on, current completion percentage is being outputted to log file (by default "),s("span",{staticClass:"notranslate"},[s("em",[t._v("/var/restore_infected/acronis_backup.log")])]),t._v(". Returns "),s("span",{staticClass:"notranslate"},[s("code",[t._v("True")])]),t._v(" if backup is successful and "),s("span",{staticClass:"notranslate"},[s("code",[t._v("False")])]),t._v(" otherwise.")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" backup_backends\n acronis "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" backup_backends"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'acronis'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n acronis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("make_initial_backup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("trace"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])])]),t._v(" "),s("h3",{attrs:{id:"creating-custom-backup-backend-plugin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-custom-backup-backend-plugin","aria-hidden":"true"}},[t._v("#")]),t._v(" Creating Custom Backup Backend Plugin")]),t._v(" "),s("h4",{attrs:{id:"creating-module"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-module","aria-hidden":"true"}},[t._v("#")]),t._v(" Creating Module")]),t._v(" "),s("p",[t._v("To create a plugin for a particular backup backend a python module should be created in "),s("span",{staticClass:"notranslate"},[s("code",[t._v("backup_backends")])]),t._v(" folder. The plugin will be registered automatically when a function "),s("span",{staticClass:"notranslate"},[s("code",[t._v("backend(name)")])]),t._v(" from "),s("span",{staticClass:"notranslate"},[s("code",[t._v("backup_backends")])]),t._v(" module is called.\nIf the plugin should be used only in some appropriate systems environment "),s("span",{staticClass:"notranslate"},[s("code",[t._v("is_suitable")])]),t._v(" function could be implemented, which should return Boolean. It will be called during "),s("span",{staticClass:"notranslate"},[s("code",[t._v("backend(name)")])]),t._v(" from "),s("span",{staticClass:"notranslate"},[s("code",[t._v("backup_backends")])]),t._v(" function call and if "),s("span",{staticClass:"notranslate"},[s("code",[t._v("is_suitable False")])]),t._v(", then "),s("span",{staticClass:"notranslate"},[s("code",[t._v("BackendNonApplicableError")])]),t._v(" exception will be raised.")]),t._v(" "),s("p",[t._v("Here is an example of "),s("span",{staticClass:"notranslate"},[s("code",[t._v("is_suitable")])]),t._v(" function for DirectAdmin module:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("is_suitable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("isfile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/usr/local/directadmin/directadmin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),s("h4",{attrs:{id:"defining-classes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#defining-classes","aria-hidden":"true"}},[t._v("#")]),t._v(" Defining Classes")]),t._v(" "),s("p",[t._v("There are two mandatory classes that have to be implemented in the plugin.")]),t._v(" "),s("h4",{attrs:{id:"backup-class"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#backup-class","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("span",{staticClass:"notranslate"},[t._v("Backup")]),t._v(" Class")]),t._v(" "),s("p",[t._v("This class represents a backup. It can have any name since it is not directly referenced to from the outside of the module. It can either be inherited from")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("backup_backends_lib.BackupBase\n")])])])]),t._v(" "),s("p",[t._v("which already have some features (e.g. comparison) implemented or it can be written from scratch. The class must define a method "),s("span",{staticClass:"notranslate"},[s("code",[t._v("file_data")])]),t._v(" that returns a "),s("span",{staticClass:"notranslate"},[t._v("FileData")]),t._v(" object (described below). Objects of this class should also be comparable by the date created as if they were actual backups.")]),t._v(" "),s("h4",{attrs:{id:"filedata-class"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#filedata-class","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("span",{staticClass:"notranslate"},[t._v("FileData")]),t._v(" Class")]),t._v(" "),s("p",[t._v("The second class that has to be implemented is "),s("span",{staticClass:"notranslate"},[s("code",[t._v("FileData")])]),t._v(" which represents a file in a backup. It must have file size, modify time and a method "),s("span",{staticClass:"notranslate"},[s("code",[t._v("restore")])]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"implementing-api-functions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#implementing-api-functions","aria-hidden":"true"}},[t._v("#")]),t._v(" Implementing API Functions")]),t._v(" "),s("p",[t._v("There are 3 functions in the plugin, but only one of them is mandatory - "),s("span",{staticClass:"notranslate"},[s("code",[t._v("backups")])]),t._v(". This function returns a list of Backup instances. Optional functions are "),s("span",{staticClass:"notranslate"},[s("code",[t._v("init")])]),t._v(", "),s("span",{staticClass:"notranslate"},[s("code",[t._v("cleanup")])]),t._v(", and "),s("span",{staticClass:"notranslate"},[s("code",[t._v("info")])]),t._v(" that are responsible for the initialization, cleanup and getting some information of the plugin respectively.")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("backups")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("until"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cleanup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   …\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" \n")])])])]),t._v(" "),s("p",[t._v("Depending on the features of the backend being integrated, the plugin might have one or more classes and functions responsible to authorise on the backup server and retrieve data from it, however only functions "),s("span",{staticClass:"notranslate"},[s("code",[t._v("init")])]),t._v(", "),s("span",{staticClass:"notranslate"},[s("code",[t._v("backups")])]),t._v(", "),s("span",{staticClass:"notranslate"},[s("code",[t._v("cleanup")])]),t._v(", and "),s("span",{staticClass:"notranslate"},[s("code",[t._v("info")])]),t._v(" are called from the outside of the module.")]),t._v(" "),s("p",[t._v("To check that the plugin works as intended try passing your plugin name to the CLI for example like this:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("restore_infected "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("your_backend_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),t._v("\n")])])])]),t._v(" "),s("p",[t._v("To be used in asynchronous libraries "),s("span",{staticClass:"notranslate"},[s("code",[t._v("async_restore_infected")])]),t._v(" routine has been added. Typical use case:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-Python 3 extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" logging\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" backup_backends\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" restore_infected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("restore "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" async_restore_infected\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" defence360agent"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("malscan"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scanner "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" MalwareScanner\n \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_custom_scan_function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("files"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" files"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    still_infected "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    scanner "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MalwareScanner"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("scan_filelist"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    scanner"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("start"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("files"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    result "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" scanner"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("async_wait"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'results'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        still_infected "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'results'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" still_infected\n \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DummyDumper")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    @"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("classmethod")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("do_restore")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cls"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" files"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        backend "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" backup_backends"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("backend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'cpanel'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" async_restore_infected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            backend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" files"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" scan_func"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("_custom_scan_function\n")])])])]),t._v(" "),s("p",[t._v("For Acronis backup two restore modes are available:")]),t._v(" "),s("ul",[s("li",[s("strong",[s("span",{staticClass:"notranslate"},[t._v("Download")]),t._v(" mode")]),t._v(" – a file to be restored is simply pulled by HTTP from backup server")]),t._v(" "),s("li",[s("strong",[s("span",{staticClass:"notranslate"},[t._v("Recovery")]),t._v(" mode")]),t._v("  – "),s("span",{staticClass:"notranslate"},[s("code",[t._v("restore_infected")])]),t._v(" just sends command to backup server and then waits for the file to be restored is actually placed to expected folder. Its size is equal to expected one.")])]),t._v(" "),s("p",[t._v("Recovery mode is used by default because it restores file owner and permissions, too. Though downloading mode can be enabled with passing "),s("span",{staticClass:"notranslate"},[s("code",[t._v("use_download")])]),t._v(" option to "),s("span",{staticClass:"notranslate"},[s("code",[t._v("restore_infected")])]),t._v(" function. The second optional parameter - "),s("span",{staticClass:"notranslate"},[s("code",[t._v("timeout")])]),t._v(" can be passed to "),s("span",{staticClass:"notranslate"},[s("code",[t._v("restore_infected")])]),t._v(" function to change the default waiting time (time to wait while a file to be restored is being pulled by recovery agent). By default timeout is 600 seconds.")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("title: Hosting Panels Firewall Rulesets Specific Settings & ModSec\nmeta:")]),t._v(" "),s("ul",[s("li",[t._v("name: description\ncontent: Discover Hosting Panels Firewall Rulesets specific settings including modsec rules in Imunify360 security suite.")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"hosting-panels-firewall-rulesets-specific-settings-modsecurity"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hosting-panels-firewall-rulesets-specific-settings-modsecurity","aria-hidden":"true"}},[t._v("#")]),t._v(" Hosting Panels Firewall Rulesets Specific Settings & ModSecurity")]),t._v(" "),s("p",[t._v("This section includes specific settings for each hosting panel that Imunify360 supports. It is important to follow these instructions to setup Imunify360 plugin properly.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(", the important software for Imunify360, is not installed automatically during Imunify360 installation process. Without "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(", Imunify360 will lack the following features:")]),t._v(" "),s("ul",[s("li",[t._v("Web application firewall")]),t._v(" "),s("li",[t._v("Malware scanning of files uploaded using web")])])]),s("p",[s("span",{staticClass:"notranslate"},[t._v("Mod_security")]),t._v(" installation process is specific for different panels:")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Find the official cPanel documentation "),s("a",{attrs:{href:"https://documentation.cpanel.net/display/EA4/Apache+Module%3A+ModSecurity#ApacheModule:ModSecurity-InstallModSecHowtoinstalloruninstallmod_security2",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[t._v("Find the official Plesk documentation "),s("a",{attrs:{href:"https://docs.plesk.com/en-US/onyx/administrator-guide/server-administration/web-application-firewall-modsecurity.73383/",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1)])])]),t._v(" "),s("div",{staticClass:"danger custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Important!")]),s("p",[t._v("If "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" is installed after Imunify360, it is important to execute the following command to add "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" ruleset to Imunify360:")]),t._v(" "),s("p",[t._v("For cPanel/Plesk/DirectAdmin/Stand-alone:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify360-agent install-vendors\n")])])])])]),s("p",[t._v("If "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" is installed before Imunify360, the rules will be installed automatically.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("If Imunify360 installer detects any existing ruleset, it installs only minimal set of its rules. So, you need to disable all third-party rulesets prior to Imunify360 installation to get the full ruleset installed automatically.")])]),s("h3",{attrs:{id:"cpanel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cpanel","aria-hidden":"true"}},[t._v("#")]),t._v(" cPanel")]),t._v(" "),s("p",[t._v("It is possible to enable "),s("span",{staticClass:"notranslate"},[t._v("Service Status")]),t._v(" checker for Imunify360. To do so, perform the following steps:")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Go to "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Service Configuration")])]),t._v(" and choose "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Service Manager")])]),t._v(".")])]),t._v(" "),s("li",[s("p",[t._v("In "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Additional Services")])]),t._v(" section tick "),s("span",{staticClass:"notranslate"},[s("code",[t._v("imunify360")])]),t._v(" and "),s("span",{staticClass:"notranslate"},[s("code",[t._v("imunify360-webshield")])]),t._v(" checkboxes.")])]),t._v(" "),s("li",[s("p",[t._v("Click "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Save")])]),t._v(" and wait until cPanel enables the "),s("span",{staticClass:"notranslate"},[t._v("Service Status")]),t._v(" checker for Imunify360.")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/cpanel_set01.png",alt:""}})]),t._v(" "),s("p",[t._v("If succeeded, the status of Imunify360 service will be displayed at "),s("span",{staticClass:"notranslate"},[t._v("Service Status")]),t._v(" section of "),s("span",{staticClass:"notranslate"},[t._v("Server Status")]),t._v(".")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/cpanel_set02.png",alt:""}})]),t._v(" "),s("h4",{attrs:{id:"modsecurity-settings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#modsecurity-settings","aria-hidden":"true"}},[t._v("#")]),t._v(" ModSecurity Settings")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("Since version 92, cPanel is adding experimental support of ModSecurity 3.x and starting from version 5.7, we implement "),s("strong",[t._v("experimental")]),t._v(" support of ModSecurity version 3 on cPanel. Since the support is experimental, there are some limitations. Please find them "),s("RouterLink",{attrs:{to:"/ids_integration/#modsecurity-3-apache-limitations"}},[t._v("here")]),t._v(".")],1)]),s("p",[t._v("Recommended "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" settings are:")]),t._v(" "),s("ul",[s("li",[s("span",{staticClass:"notranslate"},[t._v("Audit Log Level – Only log noteworthy transactions")])]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[t._v("Connections Engine – Do not process the rules")])]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[t._v("Rules Engine – Process the rules")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/modsecuritysettings.png",alt:""}})]),t._v(" "),s("p",[t._v("It’s also recommended to disable any third-party "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" vendors except Imunify360 ruleset (especially "),s("strong",[t._v("OWASP")]),t._v(" and "),s("strong",[t._v("Comodo")]),t._v(" ). These rulesets can cause large number of false-positives and duplicate Imunify360 ruleset.")]),t._v(" "),s("p",[t._v("To do so, go to "),s("span",{staticClass:"notranslate"},[t._v("ModSecurity Vendors")]),t._v(" section of cPanel main menu, and switch to "),s("span",{staticClass:"notranslate"},[s("code",[t._v("Off")])]),t._v(" all enabled vendors except Imunify360 ruleset.\nIf there is no Imunify360 ruleset installed, run "),s("span",{staticClass:"notranslate"},[s("code",[t._v("imunify360-agent install-vendors")])]),t._v(" command.")]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/ModSecVendors.png",alt:""}})]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Enable rules auto-update. Otherwise, you won't get important updates of ModSecurity ruleset in time")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("For Apache run the following command:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("/usr/local/cpanel/scripts/modsec_vendor enable-updates imunify360-full-apache\n")])])])])]),t._v(" "),s("li",[s("p",[t._v("For LiteSpeed run the following command:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("/usr/local/cpanel/scripts/modsec_vendor enable-updates imunify360-full-litespeed \n")])])])])])]),t._v(" "),s("p",[t._v("See details "),s("a",{attrs:{href:"https://documentation.cpanel.net/display/82Docs/ModSecurity+Vendors#ModSecurityVendors-Enableordisableupdates",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("Or you can use "),s("a",{attrs:{href:"https://documentation.cpanel.net/display/DD/WHM+API+1+Functions+-+modsec_enable_vendor_updates",target:"_blank",rel:"noopener noreferrer"}},[t._v("WHMAPI1"),s("OutboundLink")],1),t._v(" to enable vendor auto-updates.")])]),t._v(" "),s("li",[s("p",[t._v("It is possible to block ModSecurity rules only for IPs that belong to some country. More info can be found in "),s("RouterLink",{attrs:{to:"/faq_and_known_issues/#_9-disabling-waf-rules-for-certain-countries"}},[t._v("FAQ")])],1)])]),t._v(" "),s("h4",{attrs:{id:"modsecurity-3-apache-limitations"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#modsecurity-3-apache-limitations","aria-hidden":"true"}},[t._v("#")]),t._v(" ModSecurity 3 + Apache limitations")]),t._v(" "),s("p",[t._v("Since version 92, cPanel is adding experimental support of ModSecurity 3.x and starting from version 5.7, we implement "),s("strong",[t._v("experimental")]),t._v(" support of ModSecurity version 3 on cPanel. There are still some issues that prevent some Imunify360 features from working property. The feature limitations are:")]),t._v(" "),s("ul",[s("li",[t._v("working with mod_ruid2")]),t._v(" "),s("li",[t._v("working with mod_remoteip")]),t._v(" "),s("li",[t._v("app-specific ruleset feature")]),t._v(" "),s("li",[t._v("HackerTrap")]),t._v(" "),s("li",[t._v("uploaded files scanning")]),t._v(" "),s("li",[t._v("simple password redirect")])]),t._v(" "),s("h3",{attrs:{id:"plesk"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#plesk","aria-hidden":"true"}},[t._v("#")]),t._v(" Plesk")]),t._v(" "),s("p",[t._v("It is not recommended to use firewalld and Plesk Firewall simultaneously, because Plesk does not fully support such configuration. We recommend to disable firewalld by running the command on the server:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("systemctl disable firewalld\n")])])])]),t._v(" "),s("p",[t._v("Read more about the problem at Plesk Help Center in this "),s("a",{attrs:{href:"https://support.plesk.com/hc/en-us/articles/115000905285-Plesk-Firewall-and-firewalld",target:"_blank",rel:"noopener noreferrer"}},[t._v("thread"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"modsecurity-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#modsecurity-configuration","aria-hidden":"true"}},[t._v("#")]),t._v(" ModSecurity Configuration")]),t._v(" "),s("ul",[s("li",[s("span",{staticClass:"notranslate"},[t._v("Web application firewall mode – On")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"/images/modsecurityconfigurationpleskonyx.png",alt:""}})]),t._v(" "),s("p",[t._v("If any "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" ruleset was installed during Imunify360 installation, Imunify360 will not install its own ruleset, because Plesk supports only one ruleset at once.")]),t._v(" "),s("p",[t._v("To check, if Imunify360 ruleset is installed, run the following as root:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# plesk bin server_pref --show-web-app-firewall | grep "\\[waf-rule-set\\]" -A2')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("waf-rule-set"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ncustom\n")])])])]),t._v(" "),s("p",[t._v("If the output does not contain imunify360, for example:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# plesk bin server_pref --show-web-app-firewall | grep "\\[waf-rule-set\\]" -A2')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("waf-rule-set"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ncomodo_free\n")])])])]),t._v(" "),s("p",[t._v("Then install Imunify360 ruleset and check it again:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# imunify360-agent install-vendors")]),t._v("\nOK\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# plesk bin server_pref --show-web-app-firewall | grep "\\[waf-rule-set\\]" -A2')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("waf-rule-set"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ncustom\n")])])])]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("Please make sure that "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Update rule sets")])]),t._v(" option is disabled in your Plesk "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Web Application Firewall")])]),t._v(" interface on the "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Settings")])]),t._v(" tab.")])]),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("Note that in the current version of Plesk, "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Update rule sets")])]),t._v(" option is available if one of the "),s("span",{staticClass:"notranslate"},[s("em",[t._v("Atomic Basic ModSecurity/Advanced ModSecurity Rules by Atomicorp/Comodo ModSecurity")])]),t._v(" Rule Set is enabled.")])]),s("h3",{attrs:{id:"directadmin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#directadmin","aria-hidden":"true"}},[t._v("#")]),t._v(" DirectAdmin")]),t._v(" "),s("p",[t._v("During installation on DirectAdmin, Imunify360 will try to install "),s("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" automatically using custombuild 2.0.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("Automatic installation of Imunify360 ruleset is only supported with custombuild 2.0.")])]),s("p",[t._v("The following values in the custombuild configuration are required for the installation of Imunify360 ModSecurity ruleset:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("modsecurity=yes\nmodsecurity_ruleset=no\n")])])])])},[],!1,null,null,null);a.default=n.exports}}]);